<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="自从小学期有幸获得同学的申必VPN后，就总觉得，既然能连上Google Play Store了，就应该把那个游戏下下来，体验一下正版之类的。这样的想法总是若隐若现，而那个游戏的名字我又早已淡忘。于是就这么一直拖着，直到拖到了最近才想起来，原来是The Blockheads啊。 这是一个我从初中就开始玩的游戏。作为移动平台的独立游戏，其综合素质不可谓不高。当年曾经拿下过App Store免费榜的榜首">
<meta name="keywords" content="TheBlockheads">
<meta property="og:type" content="article">
<meta property="og:title" content="The Blockheads存档修改工具开发记录">
<meta property="og:url" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/index.html">
<meta property="og:site_name" content="Medioqrity&#39;s Blog">
<meta property="og:description" content="自从小学期有幸获得同学的申必VPN后，就总觉得，既然能连上Google Play Store了，就应该把那个游戏下下来，体验一下正版之类的。这样的想法总是若隐若现，而那个游戏的名字我又早已淡忘。于是就这么一直拖着，直到拖到了最近才想起来，原来是The Blockheads啊。 这是一个我从初中就开始玩的游戏。作为移动平台的独立游戏，其综合素质不可谓不高。当年曾经拿下过App Store免费榜的榜首">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/raw_data.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/output.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/parsed_output_dw.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/modify_test.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/ALLBLOCKS.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/solid_unknown_block.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/modify_inventory_1.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/item_enum_test.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/recursive_items.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/item_count_test.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/durability_code_output.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/durability.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/durability_negative_test.png">
<meta property="og:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/durability_titanium.png">
<meta property="og:updated_time" content="2020-03-03T21:13:54.894Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="The Blockheads存档修改工具开发记录">
<meta name="twitter:description" content="自从小学期有幸获得同学的申必VPN后，就总觉得，既然能连上Google Play Store了，就应该把那个游戏下下来，体验一下正版之类的。这样的想法总是若隐若现，而那个游戏的名字我又早已淡忘。于是就这么一直拖着，直到拖到了最近才想起来，原来是The Blockheads啊。 这是一个我从初中就开始玩的游戏。作为移动平台的独立游戏，其综合素质不可谓不高。当年曾经拿下过App Store免费榜的榜首">
<meta name="twitter:image" content="https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/raw_data.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>The Blockheads存档修改工具开发记录</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
    <link href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css" rel="stylesheet"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body class="max-width mx-auto px3 ltr">    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/archives/">文章</a></li>
         
          <li><a href="/about/">关于</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2020/02/13/从零写一个编译器-simpleJava-Compiler/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&text=The Blockheads存档修改工具开发记录"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&title=The Blockheads存档修改工具开发记录"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&is_video=false&description=The Blockheads存档修改工具开发记录"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=The Blockheads存档修改工具开发记录&body=Check out this article: https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&title=The Blockheads存档修改工具开发记录"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&title=The Blockheads存档修改工具开发记录"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&title=The Blockheads存档修改工具开发记录"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&title=The Blockheads存档修改工具开发记录"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&name=The Blockheads存档修改工具开发记录&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#读存档"><span class="toc-number">1.</span> <span class="toc-text">读存档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#写存档"><span class="toc-number">2.</span> <span class="toc-text">写存档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Inventory迷思"><span class="toc-number">3.</span> <span class="toc-text">Inventory迷思</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#损耗"><span class="toc-number">4.</span> <span class="toc-text">损耗</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        The Blockheads存档修改工具开发记录
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Medioqrity's Blog</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-03-02T15:45:56.000Z" itemprop="datePublished">2020-03-02</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/TheBlockheads/">TheBlockheads</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>自从小学期有幸获得同学的申必VPN后，就总觉得，既然能连上Google Play Store了，就应该把<em>那个游戏</em>下下来，体验一下正版之类的。这样的想法总是若隐若现，而<em>那个游戏</em>的名字我又早已淡忘。于是就这么一直拖着，直到拖到了最近才想起来，原来是The Blockheads啊。</p>
<p>这是一个我从初中就开始玩的游戏。作为移动平台的独立游戏，其综合素质不可谓不高。当年曾经拿下过App Store免费榜的榜首。即便是原作者已经几乎是弃坑了几年之后，其论坛依然有不少活跃用户。</p>
<p>很不幸的是，作为一个沙盒游戏，其创造力却被移动平台，合成时间机制以及纯生存所禁锢:</p>
<ul>
<li>移动平台使得更改其存档极其困难。要么root要么越狱，除此之外没有别的办法。</li>
<li>合成时间机制。由于合成物品需要时间，引入用来加速合成的道具自然也就能带来除了广告之外的另一笔收入。但是对于巨型建筑工程来说，所需要的合成时间通常会高达上万小时。要么修改水晶，要么开启服务器号召大家一起建造。在玩家群体如此式微的现在，想要召集高质量的建筑师大概不怎么可行。这样看来的话，要解决合成时间的问题可能只剩下root然后改水晶数量了吧。</li>
<li>纯生存。虽然在引入了自定义机制之后，已经相比以前要方便许多了，但还是没办法轻松地拆掉钢块钛块之类的。而且就算交易门免费，也需要有存储的箱子之类的。而且也不能复制粘贴批量修改（为什么会有这种功能啊喂！），也不能放置不合法的方块。看看隔壁的小木斧和MCEdit，总之多少有些羡慕。</li>
</ul>
<p>在minecraft因为mod和本体不断更新而风生水起的时候，看着另外一个同样很优秀的游戏因为这种限制而不断凋零，对于喜欢这游戏的玩家来说显然不是什么好事。</p>
<p>在建造巨型建筑的时候，想要复制一个非常复杂的结构，并粘贴到某个位置，显然不可能。看腻了BH自带的地形，想要自己写个地形生成器，发现没有API。将一些不可分割的元素拆分后也许能做出相当棒的效果，然而因为不可拆分所以同样做不到。</p>
<p>多可惜啊。</p>
<p>上github转了一圈，反正没看到有谁写过类似的东西，大多不过是聊天机器人。这样的话，就只能自己动手了。</p>
<h2 id="读存档"><a href="#读存档" class="headerlink" title="读存档"></a>读存档</h2><p>上手一看，存档文件夹里就躺着个world_db，里面就俩文件，<code>data.mdb</code>和<code>lock.mdb</code>。照理说<code>.mdb</code>应该是Access的格式，然而很可惜并打不开。</p>
<p>无奈，上网查了一下<code>.mdb</code>还可能是什么存储格式，但还是无功而返。针对文件内容的分析也同样失败了。</p>
<p>心态有点小崩，返回存档又看了几眼，发现不仅是world_db，lightBlocks和server_db同样也都只有<code>data.mdb</code>和<code>lock.mdb</code>。由于db的全称是database，不免让人想到这一数据库的特点就是同时存储<code>data.mdb</code>和<code>lock.mdb</code>来作为整个数据库。因此把这两个名字一起搜一下，果然…</p>
<p>卧槽，为什么会跳出来Caffe的结果啊?? 现在已经先进到要用机器学习来保存存档了吗??</p>
<p>不过也总比什么证据都得不到要好。进这个stackOverflow的问题一看，提到了个叫lmdb的东西。我想可能就是它了。遂搜索，然而一个GUI工具都没找着，只找到一个python的模块和一个<a href="https://lmdb.readthedocs.io/en/release/" target="_blank" rel="noopener">文档</a>。嗬，感情我还得学完这API才能确定自己猜的对不对呗?</p>
<p>想着似乎也就这么一个可能的可行路径了，就还是试了下去。好在最后的确成功读出了数据。</p>
<p>总的来说，1.7的存档格式相比之前有些改动。现在的1.7采用的是lmdb，将数据全部存放在几个数据库里。而以前各个文件都分散地存储在不同的文件夹里。新的存储方式提供了完整性保证，杜绝了通过<em>复制物品栏文件后，把物品栏的物品放进箱子里，再把物品栏复制回来</em>的方法刷物品。另外，由于lmdb提供ACID的事务，因此不用再担心存档在读写过程中出现问题而导致存档损坏的情况了。<del>要是再出问题那就可以实锤dave的代码有bug了。</del></p>
<p>只是单纯的读出来而不做任何处理的话，会得到这种申必数据:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/raw_data.png" alt="raw_data"></p>
<p>就是二进制和xml plist组成的地狱绘图。</p>
<p>好在，其中的区块数据和以前一样，还是gzip压缩。而二进制的bplist也同样有库可以解决。xml plist则更不用说，python自带了plistlib可以用于解决这一问题。</p>
<p>然而，在写解析函数的时候，我发现还会出现那种xml plist里面套plist或者gzip或者base64的情况，属实膈应人。没办法，还是只能依赖递归了:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process</span><span class="params">(v)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> isinstance(v, list):</span><br><span class="line">        <span class="keyword">for</span> i, _ <span class="keyword">in</span> enumerate(v):</span><br><span class="line">            v[i] = process(_)</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line">    <span class="keyword">elif</span> isinstance(v, dict):</span><br><span class="line">        <span class="keyword">for</span> a, b <span class="keyword">in</span> v.items():</span><br><span class="line">            v[a] = process(b)</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line">    <span class="keyword">elif</span> isinstance(v, bytes):</span><br><span class="line">        f = io.BytesIO(v)</span><br><span class="line">        result = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> v.startswith(<span class="string">b"bplist00"</span>):</span><br><span class="line">            result = ccl_bplist.load(f)</span><br><span class="line">            result = process(result)</span><br><span class="line">        <span class="keyword">elif</span> v.startswith(<span class="string">b"\x1f\x8b"</span>):</span><br><span class="line">            <span class="keyword">with</span> gzip.open(f, <span class="string">"rb"</span>) <span class="keyword">as</span> f2:</span><br><span class="line">                content = f2.read()</span><br><span class="line">            result = process(content)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = v</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> v</span><br></pre></td></tr></table></figure>
<p>然后把文件写到随便哪个文件夹下，方便查询:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">env = lmdb.open(FOLDER + <span class="string">"world_db"</span>, readonly=<span class="literal">True</span>, max_dbs=<span class="number">114514</span>)</span><br><span class="line"><span class="keyword">with</span> env.begin() <span class="keyword">as</span> txn:</span><br><span class="line">    cursor = txn.cursor()</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> cursor:</span><br><span class="line">        sub_db = env.open_db(k, txn=txn, create=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">for</span> k2, v2 <span class="keyword">in</span> txn.cursor(sub_db):</span><br><span class="line">            filename = FOLDER + OUT_FOLDER + <span class="string">"%s_%s"</span> \</span><br><span class="line">                       % (k.decode(), k2.decode().replace(<span class="string">"/"</span>, <span class="string">"_"</span>))</span><br><span class="line">            result = process(v2)</span><br><span class="line">            <span class="keyword">if</span> isinstance(result, bytes):</span><br><span class="line">                <span class="keyword">with</span> open(filename, <span class="string">"wb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(result)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">with</span> open(filename, <span class="string">"w"</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(pprint.pformat(result))</span><br><span class="line">env.close()</span><br></pre></td></tr></table></figure>
<p>就能得到一大堆乱七八糟的文件:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/output.png" alt="output"></p>
<p>随便打开一个看看:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/parsed_output_dw.png" alt="parsed_output_dw"></p>
<p>能读了！！</p>
<p>不过只是能读那有个🔨用，改不了还不是个鸡肋? 修改工具的脸都给你丢完了（东北腔</p>
<h2 id="写存档"><a href="#写存档" class="headerlink" title="写存档"></a>写存档</h2><p>写存档说实话还挺麻烦的。在这里就不透露过多技术细节了。</p>
<p>简而言之，world_db下会分有几个子数据库，子数据库内存储的都是键值对。值全部都是二进制数据，而且类型各不相同。而有些类型又是容器，容器内又有不同的格式，总之相当混乱。</p>
<p>目前已知的有下面这些:</p>
<ul>
<li>bplist，苹果的binary property list</li>
<li>plist，普通的property list，以xml的形式存储</li>
<li>base64</li>
<li>gzip</li>
</ul>
<p>那么核心目标就是，在分辨并解析这些内容的同时，确保有办法能够让它们正确地被打包成二进制数据。为此，我设置了一个抽象类，名为<code>Exportable</code>，表示这是可以导出成二进制数据的类。这样的类必须提供一个名为<code>export</code>的方法，用于在导出时使用。</p>
<p>大致上就是如此。</p>
<p>一个很好的检测<code>export</code>是否在正确工作的方法就是把export出来的二进制数据丢进该类的构造方法里，看看能不能解析出同样的数据来。我想，能够通过这样的测试的话，大概率也就不会在真实数据上翻车了。</p>
<p>实现过程总之还是有点头疼的，毕竟总是要处理递归的结构。debug体验也不是很友好。稍微写错一点，游戏就不认这个存档，也不告诉你错哪了。不过逆向分析别人的东西，本来就不会有什么debug体验就是了。</p>
<p>好在最后成功地跑起来了。为了展示其能力，特地写了一段用来随机放置时间水晶的代码:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</span><br><span class="line">    <span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line">    <span class="keyword">from</span> blockType <span class="keyword">import</span> BlockType</span><br><span class="line">    FOLDER = <span class="string">"./test_data/saves/c8185b81198a1890dac4b621677a9229/"</span></span><br><span class="line">    gs = GameSave(FOLDER)</span><br><span class="line">    <span class="keyword">for</span> name, chunk <span class="keyword">in</span> gs.chunks.items():</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">128</span>):</span><br><span class="line">            block = chunk.get_block(randint(<span class="number">0</span>, <span class="number">31</span>), randint(<span class="number">0</span>, <span class="number">31</span>))</span><br><span class="line">            block.set_attr(<span class="string">"first_layer_id"</span>, BlockType.TIME_CRYSTAL.value)</span><br><span class="line">    print(<span class="string">"saving..."</span>)</span><br><span class="line">    gs.save(<span class="string">"./test_data/saves/out/"</span>)</span><br></pre></td></tr></table></figure>
<p>大致思路就是遍历所有chunk，跑128次随机，每次随机俩数字，把这俩数字对应的方块改成时间水晶就完事了。</p>
<p>成果如下:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/modify_test.png" alt="modify_test"></p>
<p><em>本来觉得用这样的例子不太好，毕竟dave大还是要靠看广告送水晶的方法来恰饭的。但是转念一想，要想改存档，起码得root或者越狱。既然都root/越狱了，改个水晶还不简单?</em></p>
<p>再测一下1.7所有方块的id。考虑到不可能超过256种，所以用16 * 16的格子应该就能满足要求了。</p>
<p>代码如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">FOLDER = <span class="string">"./test_data/saves/c8185b81198a1890dac4b621677a9229/"</span></span><br><span class="line">gs = GameSave(FOLDER)</span><br><span class="line">info = gs.get_info()</span><br><span class="line">chunk_pos = [_ &gt;&gt; <span class="number">5</span> <span class="keyword">for</span> _ <span class="keyword">in</span> info[<span class="string">"start_portal_pos"</span>]]</span><br><span class="line">chunk_pos[<span class="number">1</span>] += <span class="number">1</span></span><br><span class="line">chunk = gs.get_chunk(*chunk_pos)</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">15</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">        b = chunk.get_block(x, y)</span><br><span class="line">        b.set_attr(<span class="string">"first_layer_id"</span>, ((<span class="number">15</span> - y) &lt;&lt; <span class="number">4</span> | x) % <span class="number">128</span>)</span><br><span class="line">gs.save(<span class="string">"./test_data/saves/out/"</span>)</span><br></pre></td></tr></table></figure>
<p>大致上就是获取出生点上方的区块，把它从(0, 0)到(15, 15)的部分按照从左到右，从上到下的方法枚举出来。结果如下:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/ALLBLOCKS.png" alt="ALLBLOCKS"></p>
<p>可以看到有不少不能确定的方块。神奇的是，对于0号和78~127号方块来说，尽管它们是透明的，但它们却都是实打实的实体方块:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/solid_unknown_block.png" alt="solid_unknown_block"></p>
<p>矿物并没有出现。我猜可能是存在类似mc染色玻璃和木板那样的方块附加值。毕竟一个方块花了64个字节描述，而现在只知道其中两个字节的意思。</p>
<h2 id="Inventory迷思"><a href="#Inventory迷思" class="headerlink" title="Inventory迷思"></a>Inventory迷思</h2><p>在能基本改造世界后，就该考虑物品栏了。</p>
<p>要测Inventory的存储方式，自然只能依靠控制变量法了。</p>
<p>首先先丢掉身上所有物品。然后把Inventory解出来，可以得到下面的数据:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[&apos;\x01\x00\x00\x00\x00\x00\x00\x0c&apos;], [], [], [], [], [], [], []]</span><br></pre></td></tr></table></figure>
<p>显然第一个list中的8个byte表示服装栏，大概是一个特殊的物品吧。后面七个list都是空的，符合预期。</p>
<p>接下来把土块放进第一个格子，所得数据如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[[&apos;\x01\x00\x00\x00\x00\x00\x00\x0c&apos;], [&apos;\x18\x04\x00\x00\x00\x00\x00\x0c&apos;], [], [], </span><br><span class="line">[], [], [], []]</span><br></pre></td></tr></table></figure>
<p>根据<a href="http://blockmarket.theblockheads.net/" target="_blank" rel="noopener">全球市场</a>上各物品的query string，不难看出<a href="http://blockmarket.theblockheads.net/graph/?item_id=1048" target="_blank" rel="noopener">土块</a>的id是1048。它的16进制值为<code>0x418</code>，正好对应着<code>\x18\x04</code>。这证明了物品id的存储方式是little-endian。</p>
<p>接下来是在第一个格子里放俩土块:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[&apos;\x01\x00\x00\x00\x00\x00\x00\x0c&apos;], </span><br><span class="line">[&apos;\x18\x04\x00\x00\x00\x00\x00\x0c&apos;, &apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;], </span><br><span class="line">[], [], [], [], [], []]</span><br></pre></td></tr></table></figure>
<p>卧槽，居然不是改动某一位来表示数量?? 而且最后一位也从<code>\x0c</code>变成了<code>\x00</code>，这又是什么意思呢?</p>
<p>保险起见，再放一个土块进去:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[[&apos;\x01\x00\x00\x00\x00\x00\x00\x0c&apos;], </span><br><span class="line">[&apos;\x18\x04\x00\x00\x00\x00\x00\x0c&apos;, &apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, </span><br><span class="line">&apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;], </span><br><span class="line">[], [], [], [], [], []]</span><br></pre></td></tr></table></figure>
<p>依然是<code>\x00</code>。难道第一个物品都是以<code>\x0c</code>结尾的吗?</p>
<p>把数量加上去，放13个土块试试:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[[&apos;\x01\x00\x00\x00\x00\x00\x00\x0c&apos;], [&apos;\x18\x04\x00\x00\x00\x00\x00\x0c&apos;, </span><br><span class="line">&apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, &apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, </span><br><span class="line">&apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, &apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, </span><br><span class="line">&apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, &apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, </span><br><span class="line">&apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, &apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, </span><br><span class="line">&apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, &apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, </span><br><span class="line">&apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;, &apos;\x18\x04\x00\x00\x00\x00\x00\x00&apos;], </span><br><span class="line">[], [], [], [], [], []]</span><br></pre></td></tr></table></figure>
<p>看来证实了这一猜想。</p>
<p>既然<code>\x01</code>是衣服那一栏的编号，为什么不试试<strong>把所有物品都变成衣服栏</strong>呢?</p>
<p>事实证明可行:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/modify_inventory_1.png" alt="modify_inventory_1"></p>
<p>手里拿着个手走来走去实属渗人，赶紧撇了。结果丢地上之后发现还真就捡不起来了。。</p>
<p>既然可以改，那把所有的物品都改成空的会怎样? 测了一下发现第一个物品无论如何都会被强制设置为衣物栏…还是放弃吧。</p>
<p>既然已经确定了是little-endian编码，不妨试试前几个物品id分别对应什么。代码写起来很简单:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FOLDER = <span class="string">"./test_data/saves/c8185b81198a1890dac4b621677a9229/"</span></span><br><span class="line">gs = GameSave(FOLDER)</span><br><span class="line">inv = gs[<span class="string">"world_db"</span>][<span class="string">"main"</span>][<span class="string">"blockhead_321_inventory"</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">8</span>):</span><br><span class="line">    inv[i] = [biplist.Data(struct.pack(<span class="string">"&lt;i"</span>, i + <span class="number">1</span>) + <span class="string">"\0\0\0\x0c"</span>)]</span><br><span class="line">print(gs[<span class="string">"world_db"</span>][<span class="string">"main"</span>][<span class="string">"blockhead_321_inventory"</span>])</span><br><span class="line">gs.save(<span class="string">"./test_data/saves/out/"</span>)</span><br></pre></td></tr></table></figure>
<p>就可以得到id 1 ~ 8的物品:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/item_enum_test.png" alt="item_enum_test"></p>
<p>如果有读过kaga翻译的dave大的<a href="https://tieba.baidu.com/p/2838156463" target="_blank" rel="noopener">一周年开发回顾</a>的话，会发现这个泥土和原木…实在是太有年代感了。</p>
<p>接下来把剩下7个篮子装回去，然后把所有物品掏空。所得结果如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[[&apos;\x01\x00\x00\x00\x00\x00\x00\x0c&apos;], [&apos;\x0c\x00\x00\x00\x00\x00\x03\x0c&apos;], </span><br><span class="line">[&apos;\x0c\x00\x00\x00\x00\x00\x03\x0c&apos;], [&apos;\x0c\x00\x00\x00\x00\x00\x03\x0c&apos;], </span><br><span class="line">[&apos;\x0c\x00\x00\x00\x00\x00\x00\x0c&apos;], [&apos;\x0c\x00\x00\x00\x00\x00\x00\x0c&apos;], </span><br><span class="line">[&apos;\x0c\x00\x00\x00\x00\x00\x00\x0c&apos;], [&apos;\x0c\x00\x00\x00\x00\x00\x00\x0c&apos;]]</span><br></pre></td></tr></table></figure>
<p>看来篮子的id是12。那这个<code>\x03</code>是什么鬼啊??</p>
<p>还是先不考虑这个奇葩字节，丢个土块进第一个篮子里。结果出现了不得了的东西…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[[&apos;\x01\x00\x00\x00\x00\x00\x00\x0c&apos;], </span><br><span class="line">[&apos;\x0c\x00\x00\x00\x00\x00\x03\x0c\x1f\x8b\x08\x00\x00\x00\x00\x00\x00\x07</span><br><span class="line">\x85\x8e\xcd\x0e\x820\x10\x84\xcf\xf2\x14\xb5wX\xbd\x19S0(hL\x88b\x84\x83</span><br><span class="line">\xc7\x866J\xe4\xa7i\x1b\xd1\xb7\xb7\x051\xf1d/\xfd\xba3\x9d\x1d\xb2z\xd6</span><br><span class="line">\x15zp\xa9\xca\xb6\xf1\xf1\xdc\x9ba\xc4\x9b\xa2ees\xf5q\x9em\xdd\x05^\x05</span><br><span class="line">\x0e\x99F\xc7MvIc$\xaaRi\x94\xe6\xebd\xbfA\xd8\x05\x08\x85\xa88@\x94E(M</span><br><span class="line">\xf6\xe7\x0c\x99\x0c\x80\xf8\x80\x11\xbei-\x96\x00]\xd7y\xd4\xba\xbc\xa2</span><br><span class="line">\xad\xadQA*[\xc1\xa5~%&amp;\xcc5\x1f&lt;\xa6\x196k\x86\xf4\x9f:f\xca\xcaB\x07</span><br><span class="line">\xce\x84\xdc\xf9+P\x04\xece^TJj\xe1C\xf0\x0f-M\x08\xa3\x9a\xf6\xb4\x0bO</span><br><span class="line">\xe1p:\xbfW`\x94\x08\x8c\xfe/\x19\xb1\xef@\xa0o\x188o\x0b\xd3m\x148\x01</span><br><span class="line">\x00\x00&apos;], </span><br><span class="line">[&apos;\x0c\x00\x00\x00\x00\x00\x03\x0c&apos;], [&apos;\x0c\x00\x00\x00\x00\x00\x03\x0c&apos;], </span><br><span class="line">[&apos;\x0c\x00\x00\x00\x00\x00\x03\x0c&apos;], [&apos;\x0c\x00\x00\x00\x00\x00\x00\x0c&apos;], </span><br><span class="line">[&apos;\x0c\x00\x00\x00\x00\x00\x00\x0c&apos;], [&apos;\x0c\x00\x00\x00\x00\x00\x00\x0c&apos;]]</span><br></pre></td></tr></table></figure>
<p>不是，加个土块，至于这么激动吗?? 这一个土块咋能干出这么多字节来呢??😳😳😳</p>
<p>然后仔细一看，看到<code>\x1f\x8b</code>我就知道事情不对…这不是gzip文件头吗…</p>
<p>gzip解压之后如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span><br><span class="line">&lt;plist version=&quot;1.0&quot;&gt;</span><br><span class="line">&lt;dict&gt;</span><br><span class="line">        &lt;key&gt;s&lt;/key&gt;</span><br><span class="line">        &lt;array&gt;</span><br><span class="line">                &lt;array/&gt;</span><br><span class="line">                &lt;array/&gt;</span><br><span class="line">                &lt;array/&gt;</span><br><span class="line">                &lt;array&gt;</span><br><span class="line">                        &lt;data&gt;</span><br><span class="line">                        GAQAAAAAAAw=</span><br><span class="line">                        &lt;/data&gt;</span><br><span class="line">                &lt;/array&gt;</span><br><span class="line">        &lt;/array&gt;</span><br><span class="line">&lt;/dict&gt;</span><br><span class="line">&lt;/plist&gt;</span><br></pre></td></tr></table></figure>
<p>高，实在是高。<code>GAQAAAAAAAw=</code>解码后正是<code>18 04 00 00 00 00 00 0c</code>。</p>
<p>这样的话，岂不是可以自己乱加<code>&lt;array/&gt;</code>?? 这个<code>&lt;key&gt;s&lt;/key&gt;</code>又是什么鬼?</p>
<p>不过也算是大致确定了一个物品的格式。对于长度只有8字节的，就是单个物品。对于长度大于8字节的，就是一个容器。对于长度大于8字节的，把第8字节开始到后面所有的部分都拿去解压并递归解析即可。</p>
<p>依然是省略又臭又长又煞风景的代码段，直接来看结果:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/recursive_items.png" alt="recursive_items"></p>
<p>上图中，由于实现了repr，所以物品栏中每个物品的内容都可以被详尽的打印出来，包括在chest里的basket里的物品也都能显示。上面的箭头对应着解析结果与实际物品的对应关系。</p>
<p>另外，有了之前13个土块的经验，这次来试试超过99个物品堆叠限制的测试:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gs = GameSave(<span class="string">"./test_data/saves/c8185b81198a1890dac4b621677a9229/"</span>)</span><br><span class="line">bh = gs.get_blockheads()</span><br><span class="line">inv = gs.get_inventory(bh[<span class="number">0</span>])</span><br><span class="line">inv[<span class="number">1</span>].set_id(<span class="number">1049</span>)</span><br><span class="line">inv[<span class="number">1</span>].set_count(<span class="number">1919</span>)</span><br><span class="line">gs.save(<span class="string">"./test_data/saves/out/"</span>)</span><br></pre></td></tr></table></figure>
<p>跑完之后，结果如下:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/item_count_test.png" alt="item_count_test"></p>
<h2 id="损耗"><a href="#损耗" class="headerlink" title="损耗"></a>损耗</h2><p>之前实现时，假定物品id占用4字节。结果实现了repr之后发现居然出现了item 229553894这种表示…显然占用了用来表示其他内容的字节，因此id只能是2字节了。</p>
<p>而很显然的是，对于little-endian而言的高位出现了变动，导致了item id出现了离谱的数字。而它们对应的物品id在恢复正常后，指向的都是工具。难免让人怀疑后面的位数是耐久。</p>
<p>于是写一点简单代码跑一下:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/durability_code_output.png" alt="durability_code_output"></p>
<p>总的来说就是获取inventory，然后读取指定位置的内容并打印出来。为了方便观察，我把输出的值和图标对应了起来。规律自然也是很明显了:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/durability.png" alt="durability"></p>
<p>考虑到这个数值随着损耗程度越大而越大，还是不要叫它耐久，而是叫它损耗比较好。</p>
<p>因为是little-endian，那么按照目前的数据，损耗就应该只占用第四位。</p>
<p>不过仍然需要注意的是，这是同一等级的物品的损耗。因此，数值是否可能比<code>3f</code>更大，需要对其他等级的工具进行测试。</p>
<p>在那之前，为了满足自己的恶趣味，来试试把flint spade的耐久改到7f:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/durability_negative_test.png" alt="durability_negative_test"></p>
<p>看起来就跟p的一样，不过游戏画面的确就是这样😂😂有被笑到hhhh</p>
<p>大概dave大认为控制耐久的代码不会出错，就没有在读取物品的时候添加对应的检测。<del>也算是人之常情吧，我也经常偷这种懒来着…</del></p>
<p>接下来测试一下同样是<code>3e</code>的损耗，其他物品的表现如何呢? 这次直接请出游戏中最耐用的工具之一: 钛镐。</p>
<p>简单地在之前的代码中加上<code>item.set_id(285)</code>，就能把flint spade变成titanium pickaxe。测试结果如下:</p>
<p><img src="//medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/durability_titanium.png" alt="durability_titanium"></p>
<p>我靠，如果损耗只有一位的话，那要怎么确定钛镐能够挖多少次啊?? 毕竟上限只有<code>3e</code>… 还是说，其实<code>00 3e</code>才是真正的损耗值?</p>
<p>感觉后一个猜想可行，随便敲几个石头试试，然后看看损耗值。结果如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Game\BH\BHCore (master -&gt; origin) </span><br><span class="line">λ c:/python27/python inventory_tester.py</span><br><span class="line">&apos;\x1d\x01!&gt;\x00\x00\x00\x0c&apos;</span><br></pre></td></tr></table></figure>
<p>看来第二个猜想是正确的，所以最大的损耗是<code>ff 3f</code>。可以理解为，每个物品都有16384的耐久。等级越低的物品，每使用一次耐久减少得越多。我用钛镐挖了11块石头，损耗从<code>\x00&gt;</code>变成了<code>!&gt;</code>，也就是<code>21 3e</code>。损耗增加了33点，说明钛镐挖一次石头会损失3耐久。显然不难计算出钛镐的使用次数为<code>16384 / 3 = 5461.33</code>次。</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/archives/">文章</a></li>
         
          <li><a href="/about/">关于</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#读存档"><span class="toc-number">1.</span> <span class="toc-text">读存档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#写存档"><span class="toc-number">2.</span> <span class="toc-text">写存档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Inventory迷思"><span class="toc-number">3.</span> <span class="toc-text">Inventory迷思</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#损耗"><span class="toc-number">4.</span> <span class="toc-text">损耗</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&text=The Blockheads存档修改工具开发记录"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&title=The Blockheads存档修改工具开发记录"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&is_video=false&description=The Blockheads存档修改工具开发记录"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=The Blockheads存档修改工具开发记录&body=Check out this article: https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&title=The Blockheads存档修改工具开发记录"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&title=The Blockheads存档修改工具开发记录"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&title=The Blockheads存档修改工具开发记录"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&title=The Blockheads存档修改工具开发记录"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://medioqrity.github.io/2020/03/02/The-Blockheads存档修改工具开发记录/&name=The Blockheads存档修改工具开发记录&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 medioqrity
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/archives/">文章</a></li>
         
          <li><a href="/about/">关于</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
